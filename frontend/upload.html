<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Report Case - Kind Hearts</title>
<link rel="stylesheet" href="/css/style.css">
<style>
  /* Page-specific styles */
  body { padding-top: 76px; }
  .page-wrap { min-height: calc(100vh - 76px); padding: 90px 18px 40px; display:flex; justify-content:center; align-items:flex-start; }
  .report-card { width:920px; max-width:100%; display:grid; grid-template-columns: 1fr 420px; gap:22px; align-items:start; }
  .report-info { background: rgba(0,0,0,0.45); padding:28px; border-radius:14px; color:#fff; }
  .report-form { background: rgba(255,255,255,0.98); padding:22px; border-radius:14px; box-shadow:0 12px 40px rgba(0,0,0,0.25); }
  .report-form h3{ text-align:center; margin-bottom:14px; color:#222 }
  .form-row{ margin-bottom:12px }
  .form-row label{ display:block; margin-bottom:6px; font-weight:600; color:#333 }
  .form-row input[type=text], .form-row input[type=number], .form-row textarea, .form-row select { width:100%; padding:12px 14px; border-radius:10px; border:1px solid rgba(0,0,0,0.08); }
  .form-row textarea{ min-height:100px; resize:vertical }
  .submit-btn{ width:100%; background:linear-gradient(135deg,#ff5e78,#ff8fa1); color:#fff; padding:12px; border-radius:12px; font-weight:700; border:none; cursor:pointer }

  /* Thank you overlay */
  .ty-overlay{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.6); z-index:1200 }
  .ty-card{ background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); padding:30px; border-radius:14px; text-align:center; color:#fff; box-shadow:0 18px 60px rgba(0,0,0,0.5); }
  .ty-check{ font-size:72px; color:#fff; width:120px; height:120px; line-height:120px; border-radius:999px; margin:0 auto 10px; background:linear-gradient(135deg,#34d399,#06b6d4); transform:scale(0); animation:popIn 0.6s forwards; }
  .ty-text{ font-size:28px; font-weight:800; margin-top:6px; opacity:0; animation:fadeUp 0.6s 0.4s forwards }

  @keyframes popIn { to { transform:scale(1); } }
  @keyframes fadeUp { to { opacity:1; transform:translateY(-6px); } }

  @media (max-width:980px){ .report-card{ grid-template-columns:1fr; } }
</style>
</head>
<body>

  <!-- Navbar -->
  <header>
    <nav class="navbar">
      <div class="logo">Kind <span>Hearts</span> ❤️</div>
      <ul class="nav-links" style="margin-left:auto;">
        <li><a href="index.html">Home</a></li>
        <li><a href="donate.html">Donate</a></li>
        <li><a href="upload.html" class="active">Report Case</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="login.html" onclick="localStorage.removeItem('kh_user')">Logout</a></li>
      </ul>
    </nav>
  </header>

  <main class="page-wrap">
    <div class="report-card">
      <div class="report-info">
        <h2>Report a Case</h2>
        <p style="color:#f0dfe6; line-height:1.6">Please provide as much detail as you can. Our team will review reports and follow up where necessary. If this is an emergency, contact local emergency services first.</p>
        <h4 style="margin-top:18px; color:#ffd6e0">Guidance & Resources</h4>
        <ul style="color:#fff; line-height:1.6">
          <li>How to safely approach a case</li>
          <li>Legal rights and protections</li>
          <li>Contact local support centers and helplines</li>
        </ul>
        <div style="margin-top:16px;">
          <a href="about.html" class="btn-outline">Learn More</a>
        </div>
      </div>

      <div class="report-form">
        <h3>Case Details</h3>
        <form id="uploadForm" enctype="multipart/form-data">
          <div class="form-row"><label for="person_name">Person Name</label><input id="person_name" name="person_name" type="text" placeholder="Person Name" required></div>
          <div class="form-row"><label for="age_estimate">Age Estimate</label><input id="age_estimate" name="age_estimate" type="number" placeholder="Age Estimate"></div>
          <div class="form-row"><label for="category">Category</label><select id="category" name="category" required><option value="">Select Category</option><option value="child">Child</option><option value="elderly">Elderly</option><option value="disabled">Disabled</option></select></div>
          <div class="form-row"><label for="color_description">Appearance (optional)</label><input id="color_description" name="color_description" type="text" placeholder="Color/Skin Tone or clothing"></div>
          <div class="form-row"><label for="description">Additional Details</label><textarea id="description" name="description" placeholder="Provide description, location details, or other context"></textarea></div>
          <div class="form-row"><label for="image">Upload Photo (optional)</label><input id="image" name="image" type="file" accept="image/*"></div>
          <div class="form-row"><label for="address">Location Address</label><input id="address" name="address" type="text" placeholder="Location Address"></div>
          <button type="submit" class="submit-btn">Submit Report</button>
        </form>
      </div>
    </div>
  </main>

  <!-- Thank you overlay -->
  <div class="ty-overlay" id="tyOverlay">
    <div class="ty-card">
      <div class="ty-check">✓</div>
      <div class="ty-text">Report Submitted</div>
      <div style="margin-top:12px; color:#f6eef0;">Thank you for your report. Our team will review and take appropriate action.</div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('uploadForm');
  const ty = document.getElementById('tyOverlay');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const fd = new FormData(form);
    // include added_by from logged-in user if available
    const user = JSON.parse(localStorage.getItem('kh_user') || 'null');
    if (user && user.id) fd.append('added_by', user.id);

    try {
      const res = await fetch('http://localhost:5000/api/upload/person', { method: 'POST', body: fd });
      const data = await res.json();
      if (res.ok) {
        // show stylish thank you overlay
        ty.style.display = 'flex';
        setTimeout(()=>{ ty.style.display = 'none'; form.reset(); }, 3000);
      } else {
        alert(data.message || 'Submission failed');
      }
    } catch (err) {
      console.error(err);
      alert('Network error. Your report was not submitted.');
    }
  });
});
</script>

</body>
</html>
